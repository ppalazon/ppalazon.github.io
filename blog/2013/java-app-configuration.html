<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <base href="/"/>
    <title>Java configuration pattern</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="uw7QXxk8h88xsi6Tv2LDlrOhxuDuE5zObJPs8NVdmRw" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Pablo Palazon">
    <meta name="keywords" content="">
    <meta name="generator" content"JBake">
    <!-- RSS Links -->
    <link href="/feed.xml" rel="alternate" type="application/rss+xml" title="Pablo Palazon Blog - RSS">
    <!-- Le styles -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <!--<link href="/css/asciidoctor.css" rel="stylesheet">-->
    <link href="/css/clean-blog.min.css" rel="stylesheet">
    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" href="favicon-152.png">
    <link rel="icon" href="favicon-96.png">
    <link rel="shortcut icon" href="favicon.ico">
  </head>
  <body>
    <div id="wrap">
	
<!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">Pablo Palazón</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="index.html">Home</a>
                    </li>
                    <li>
                        <a href="about.html">About</a>
                    </li>
                    <li><a href="feed.xml">Subscribe</a></li>
                    <!--<li><a href="contact.html">Contact</a></li>-->
                    <li><a href="archive.html">Archive</a></li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header" style="background-image: url('img/background/post-bg.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="site-heading">
                        <h1>Java configuration pattern</h1>
                        <hr class="small">
                        <span class="subheading">commons-configuration pattern for java apps</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->    
    <div class="container">
      <article>
	<div class="row">
        <div class="col-lg-12 col-md-12">
        	<p class="post-meta">Posted by <a href="/about.html">Pablo Palazón</a> on January 25, 2013</p>
            <p>
            	<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes, we&#8217;re developing applications that need some run-time
configuration. Those configurations depends of run-time environments.</p>
</div>
<div class="paragraph">
<p>All we need is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Properties file (*.properties)</p>
</li>
<li>
<p><a href="http://commons.apache.org/configuration/">commons-configuration-web</a> dependency</p>
</li>
<li>
<p>A Factory class</p>
</li>
<li>
<p>A Configuration class</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dev_configuration_framework">Dev configuration framework</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="factory_class_singleton">Factory Class (Singleton)</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class ConfigFactory
{
    private static ConfigFactory configFactory;
    private Config defaultConfig;

    private ConfigFactory()
    {
        try
        {
            // Default configuration with properties files
            Configuration configuration = new
                PropertiesConfiguration("configuration.properties");
            this.defaultConfig = new Config(configuration);
        }
        catch (ConfigurationException e)
        {
            e.printStackTrace();
        }

    }

    public static ConfigFactory getInstance()
    {
        if (configFactory == null)
            configFactory = new configFactory();
        return configFactory;
    }

    public Config createConfig(Configuration configuration)
    {
        return new Config(configuration);
    }

    public Config getDefaultConfig()
    {
        return defaultConfig;
    }

    public void setDefaultConfig(Config defaultConfig)
    {
        this.defaultConfig = defaultConfig;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="config_class">Config class</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class Config
{
    private Configuration configuration;

    public Config(Configuration configuration)
    {
        this.configuration = configuration;
    }

    public Boolean isActiveFeatureOne()
    {
        return this.configuration.getBoolean("feature.one");
    }

    public String getHostHttpUrl()
    {
        return this.configuration.getBoolean("host.http.url");
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="properties_file_configuration_properties">Properties file (configuration.properties)</h3>
<div class="paragraph">
<p>Commons-configuration 1.9 search <a href="http://commons.apache.org/configuration/userguide/howto_properties.html#Properties_files">property-files</a> on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in the current directory</p>
</li>
<li>
<p>in the user home directory</p>
</li>
<li>
<p>in the classpath</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-properties" data-lang="properties">feature.one=true
host.http.url=http://www.google.com</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how_to_use_it">How-to use it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="use_default_configuration">Use default configuration</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Config appConfig = ConfigFactory.getInstance().getDefaultConfig();
if(appConfig.isActiveFeatureOne())
{
   ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create_another_configuration_with_another_config_file">Create another configuration, with another config file</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">XMLConfiguration config = new XMLConfiguration("configuration.xml");
Config appConfig = ConfigFactory.getInstance().createConfig(config);
if(appConfig.isActiveFeatureOne())
{
   ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create_another_configuration_and_set_up_as_default">Create another configuration, and set-up as default</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">XMLConfiguration config = new XMLConfiguration("configuration.xml");
ConfigFactory.getInstance().setDefaultConfig(config);
...
Config appConfig = ConfigFactory.getInstance().getDefaultConfig();
if(appConfig.isActiveFeatureOne())
{
   ...
}</code></pre>
</div>
</div>
</div>
</div>
</div>
            </p>
        </div>
    </div>
	
		</article>    

          <hr/>
      <h2>Comments</h2>
      <div class="row">
          <div class="col-lg-12 col-md-12">
          <div id="disqus_thread"></div>
          <script type="text/javascript">
              /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
              var disqus_shortname = 'ppalazon'; // required: replace example with your forum shortname

              /* * * DON'T EDIT BELOW THIS LINE * * */
              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>

    </div>
		<hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a href="http://www.twitter.com/ppalazon">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="http://es.linkedin.com/in/pablopalazon/">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="http://www.github.com/ppalazon">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <p class="copyright text-muted">Copyright &copy; Pablo Palazón 2014 
                    | Mixed with <a href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> 
                    | Baked with <a href="http://jbake.org/">JBake v2.3.2</a></p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/clean-blog.min.js"></script>
    <script src="/js/run_prettify.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-33966209-1', 'auto');
      ga('send', 'pageview');

    </script>
    
  </body>
</html>